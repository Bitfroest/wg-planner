extends layout-customer

block head

block content
	h1.page-header= title
	
	h2.sub-header Infos
	
	form(method='post', action='/shopping_list/update')
		input(type='hidden', name='_csrf', value=_csrf)
		input(type='hidden', name='id', value=shoppingList.id)
		table.table.table-striped
			tr
				td Laden
				td
					input.form-control(type='text', name='shop', value=shoppingList.shop_name)
				td= shoppingList.shop_name
			tr
				td Einkäufer
				td
					script(type="application/javascript")
						|function changeBuyerButton(value,name){
						|	console.log("v:"+value+" n:"+name);
						|	document.getElementById('change-buyer').value = value;
						|	document.getElementById('buyer-button-text').textContent = name+" ";
						|};	
					input#change-buyer(type='hidden', name='buyer')
					div.input-group
						div.input-group-btn								
							button.btn.btn-default.dropdown-toggle#buyer-button(type='button', data-toggle='dropdown', size='1')
								span#buyer-button-text -- Wähle Käufer --
								span.caret
							ul.dropdown-menu(role='menu')
								each member in members
									li
										a(onclick='changeBuyerButton('+member.id+',"'+member.name+'")' value=member.id)= member.name
									if shoppingList.buyer_id == member.id
										script(type="application/javascript")
											|changeBuyerButton(
											= member.id
											|,"
											= member.name
											|");
				td= shoppingList.buyer_name
			tr
				td Wann?
				td
					span.input-group.input-flex
						input.form-control(type='text', name='shopped_date', value=formatDate(shoppingList.shopped, 'date'))
						input.form-control(type='text', name='shopped_time', value=formatDate(shoppingList.shopped, 'time'))
				td= formatDate(shoppingList.shopped)
			tr
				td Erstellt
				td= 'von ' + shoppingList.creator_name + ' am ' + formatDate(shoppingList.created)
		input.btn.btn-primary(type='submit', value='Ändern')
	
	h2.sub-header Anteile
	
	table.table.table-striped
		each person in stats
			tr
				td= person.name
				td= formatCurrency(person.total)
		tr
			th Gesamt
			th= formatCurrency(shoppingList.total_price)
	
	h2.sub-header Items
	
	table.table.table-striped
		each item in shoppingItems
			tr
				td
					a.btn.btn-default(href='/shopping_item/' + item.id) Ansehen »
				td= item.name
				td= item.owner_name
				td= formatCurrency(item.price)
				td
					form(method='post', action='/shopping_item/delete')
						input(type='hidden', name='_csrf', value=_csrf)
						input(type='hidden', name='id', value=item.id)
						button.pull-right.btn.btn-danger(type='submit')
							span(aria-hidden='true') &times;
							span.sr-only Verlassen
				
	form(method='post', action='/shopping_item/create')
		input(type='hidden', name='_csrf', value=_csrf)
		input(type='hidden', name='shopping_list', value=shoppingList.id)
		div.input-group.input-flex
			input.form-control(type='text', name='name', placeholder='Produktname')
			select(name='owner')
				option(value='') --Wähle Besitzer--
				each member in members
					option(value=member.id)= member.name
			input.form-control(type='text', name='price', placeholder='Preis in €, z.B. 12.30')
			input.btn.btn-primary.pull-right(type='submit', value='Erstellen')
